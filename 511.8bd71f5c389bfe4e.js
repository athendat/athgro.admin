"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[511],{7511:(P,g,s)=>{s.r(g),s.d(g,{WizardModule:()=>E});var f=s(9516),b=s(1987),T=s(1818),r=s(3075),x=s(8929),C=s(2198),m=s(7625),A=s(5700),y=s(7489),e=s(5e3),F=s(2656),q=s(7967),z=s(7231),_=s(1158),I=s(5094),h=s(9808),u=s(2081),p=s(7322),J=s(7531),U=s(4107),N=s(5245),Q=s(7423),Z=s(508),B=s(6307);const w=["wizardBusinessNgForm"],k=["logoFileInput"];function S(i,n){if(1&i&&(e.TgZ(0,"fuse-alert",45),e._uU(1),e.qZA()),2&i){const o=e.oxw();e.Q6J("type",o.alert.type)("showIcon",!1),e.xp6(1),e.hij(" ",o.alert.message," ")}}function W(i,n){1&i&&e._uU(0,"Informaci\xf3n general")}function R(i,n){if(1&i&&(e.TgZ(0,"mat-option",46),e._uU(1),e.qZA()),2&i){const o=n.$implicit;e.Q6J("value",o.name),e.xp6(1),e.hij(" ",o.name," ")}}function j(i,n){1&i&&e._uU(0,"Domicilio")}function D(i,n){if(1&i&&(e.TgZ(0,"mat-option",46),e._uU(1),e.qZA()),2&i){const o=n.$implicit;e.Q6J("value",o),e.xp6(1),e.hij(" ",o," ")}}function Y(i,n){if(1&i&&(e.TgZ(0,"mat-option",46),e._uU(1),e.qZA()),2&i){const o=n.$implicit;e.Q6J("value",o.city),e.xp6(1),e.hij(" ",o.city," ")}}function O(i,n){1&i&&e._uU(0,"Imagen")}function L(i,n){1&i&&(e.TgZ(0,"span"),e._uU(1," Crear Negocio "),e.qZA())}function M(i,n){1&i&&e._UZ(0,"mat-progress-spinner",47),2&i&&e.Q6J("diameter",24)("mode","indeterminate")}const G=[{path:"",component:(()=>{class i{constructor(o,t,a,l,c,v,d,$){this._businessService=o,this._changeDetectorRef=t,this._formBuilder=a,this._fuseConfirmationService=l,this._imagesService=c,this._locationService=v,this._router=d,this.store=$,this.business=null,this.cities=[],this.domainCode="",this.domains=[],this.isLoading=!1,this.stateCode="",this.states=[],this.statesCodes=[],this.stateSelected="",this._unsubscribeAll=new x.xQ}ngOnInit(){var o;this.store.select("auth").pipe((0,C.h)(t=>null!==t),(0,m.R)(this._unsubscribeAll)).subscribe(t=>{this._user=t.user,this._changeDetectorRef.markForCheck()}),this._businessService.domains$.pipe((0,m.R)(this._unsubscribeAll)).subscribe(t=>{this.domains=t,this._changeDetectorRef.markForCheck()}),this._locationService.states$.pipe((0,m.R)(this._unsubscribeAll)).subscribe(t=>{this.states=t,this._changeDetectorRef.markForCheck()}),this._locationService.statesCodes$.pipe((0,m.R)(this._unsubscribeAll)).subscribe(t=>{this.statesCodes=t,this._changeDetectorRef.markForCheck()}),this.wizardBusinessForm=this._formBuilder.group({step1:this._formBuilder.group({_id:[""],active:[!0,[r.kI.required]],isOwner:[!0,[r.kI.required]],owner:[this._user._id,[r.kI.required]],name:["",[r.kI.required]],domain:[""],businessType:[{value:"comercio",disabled:!0},[r.kI.required]],currency:[{value:"cup",disabled:!0},[r.kI.required]],description:[""]}),step2:this._formBuilder.group({address:["",[r.kI.required]],state:["",[r.kI.required]],city:["",[r.kI.required]],country:[{value:"Cuba",disabled:!0},[r.kI.required]]}),step3:this._formBuilder.group({logoUrl:[""]})}),null===(o=this.wizardBusinessForm.get("step2.state"))||void 0===o||o.valueChanges.pipe((0,m.R)(this._unsubscribeAll)).subscribe(t=>{this._getCitiesByState(t),this._changeDetectorRef.markForCheck()})}ngOnDestroy(){this._unsubscribeAll.next(),this._unsubscribeAll.complete()}uploadLogo(o){if(!o.length)return;const a=o[0];!["image/jpeg","image/jpg","image/webp","image/png"].includes(a.type)||this._imagesService.uploadImage("business",a).subscribe(l=>{this.wizardBusinessForm.get("step3.logoUrl").setValue(l.imageUrl),this._changeDetectorRef.markForCheck()})}removeLogo(){this.wizardBusinessForm.get("step3.logoUrl").setValue(null),this._logoFileInput.nativeElement.value=null}createBusiness(){this.isLoading=!0;const o=this.wizardBusinessForm.getRawValue();let t=Object.assign(Object.assign(Object.assign({},o.step1),o.step2),o.step3);t=(0,y.omit)(t,"_id"),this._fuseConfirmationService.open({title:"Crear negocio",message:"\xbfEsta seguro que todos los datos son correctos?",icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(l=>{"confirmed"===l&&this._businessService.createMyBusiness(t).subscribe(c=>{this._fuseConfirmationService.open({title:"Confirmaci\xf3n",message:c.message,icon:{show:!0,name:"heroicons_outline:check",color:"success"},actions:{confirm:{show:!0,label:"Ok",color:"primary"},cancel:{show:!1}},dismissible:!1}).afterClosed().subscribe(d=>{"confirmed"===d&&this._router.navigateByUrl("/dashboard")}),this._changeDetectorRef.markForCheck()},c=>{this._fuseConfirmationService.open({title:`${c.statusText}: ${c.status}`,message:c.error.message,icon:{show:!0,name:"heroicons_outline:exclamation-circle",color:"error"},actions:{confirm:{show:!0,label:"Ok",color:"primary"},cancel:{show:!1}},dismissible:!1})}),this._changeDetectorRef.markForCheck()})}clearForm(){this.wizardBusinessNgForm.resetForm()}trackByFn(o,t){return t.id||o}_getCitiesByState(o){o!==this.stateSelected&&this._locationService.getCitiesByState(o).subscribe(t=>{this.cities=t,this._changeDetectorRef.markForCheck()})}}return i.\u0275fac=function(o){return new(o||i)(e.Y36(F.m),e.Y36(e.sBO),e.Y36(r.qu),e.Y36(q.R),e.Y36(z.C),e.Y36(_.a),e.Y36(f.F0),e.Y36(I.yh))},i.\u0275cmp=e.Xpm({type:i,selectors:[["ath-wizard"]],viewQuery:function(o,t){if(1&o&&(e.Gf(w,5),e.Gf(k,5)),2&o){let a;e.iGM(a=e.CRH())&&(t.wizardBusinessNgForm=a.first),e.iGM(a=e.CRH())&&(t._logoFileInput=a.first)}},decls:93,vars:46,consts:[[1,"flex","flex-col","flex-auto","min-w-0"],[1,"flex","flex-col","flex-auto","items-center","p-6","sm:p-10"],[1,"flex","flex-col","w-full","max-w-4xl"],[1,"mt-2","text-4xl","sm:text-5xl","text-primary","font-extrabold","tracking-tight","leading-tight"],[1,"mt-8","sm:mt-12","p-6","pb-7","sm:p-10","sm:pb-7","shadow","rounded-2xl","bg-card"],["class","mb-8",3,"type","showIcon",4,"ngIf"],["wizardBusinessNgForm","ngForm",1,"p-4","overflow-hidden",3,"formGroup"],["wizardBusinessNgForm",""],[3,"linear"],["wizard",""],[3,"formGroupName","stepControl"],["wizardStep1",""],["matStepLabel",""],[1,"my-6","font-medium"],[1,"flex","mb-6"],[1,"w-full","fuse-mat-no-subscript"],["matInput","","required","",3,"type","formControlName","placeholder"],[1,"flex","flex-col","gt-xs:flex-row","mb-6","gap-6"],[1,"w-full"],[3,"formControlName"],[3,"value",4,"ngFor","ngForOf","ngForTrackBy"],["matPrefix","",1,"hidden","sm:flex","icon-size-5",3,"svgIcon"],["matInput","","matTextareaAutosize","",3,"formControlName","rows","spellcheck"],[1,"flex","justify-end"],["mat-flat-button","","type","button","matStepperNext","",1,"px-8",3,"color","disabled"],["wizardStep2",""],[1,"flex","flex-col","gt-xs:flex-row","gap-6","mb-6"],["matInput","","required","",3,"type","formControlName"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["required","",3,"formControlName"],["value","Cuba"],[1,"flex","justify-between"],["mat-flat-button","","type","button","matStepperPrevious","",1,"px-8","mr-2",3,"color"],[1,"flex","flex-col","gt-sm:flex-row","items-center","justify-center"],[1,"relative","flex","items-center","justify-center","w-32","h-32","border","border-dashed","rounded-full","overflow-hidden"],[1,"absolute","inset-0","flex","items-center","justify-center","z-20"],["id","logo-file-input","type","file",1,"absolute","h-0","w-0","opacity-0","invisible","pointer-events-none",3,"multiple","accept","change"],["logoFileInput",""],["for","logo-file-input","matRipple","",1,"flex","items-center","justify-center","w-10","h-10","rounded-full","cursor-pointer","hover:bg-hover"],[1,"text-primary",3,"svgIcon"],["mat-icon-button","",1,"rounded-full",3,"click"],[1,"flex","justify-between","mt-8"],["mat-flat-button","","type","button","matStepperNext","",1,"px-8",3,"color","disabled","click"],[4,"ngIf"],[3,"diameter","mode",4,"ngIf"],[1,"mb-8",3,"type","showIcon"],[3,"value"],[3,"diameter","mode"]],template:function(o,t){if(1&o){const a=e.EpF();e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e.TgZ(3,"div",3),e._uU(4," Est\xe1 solo a tres pasos de crear su primer negocio. "),e.qZA(),e.TgZ(5,"div",4),e.YNc(6,S,2,3,"fuse-alert",5),e.TgZ(7,"form",6,7),e.TgZ(9,"mat-horizontal-stepper",8,9),e.TgZ(11,"mat-step",10,11),e.YNc(13,W,1,0,"ng-template",12),e.TgZ(14,"p",13),e._uU(15," Ingrese la informaci\xf3n m\xednima necesaria para que sus clientes conozcan el negocio. "),e.qZA(),e.TgZ(16,"div",14),e.TgZ(17,"mat-form-field",15),e.TgZ(18,"mat-label"),e._uU(19,"Nombre"),e.qZA(),e._UZ(20,"input",16),e.qZA(),e.qZA(),e.TgZ(21,"div",17),e.TgZ(22,"mat-form-field",18),e.TgZ(23,"mat-label"),e._uU(24,"Sector"),e.qZA(),e.TgZ(25,"mat-select",19),e.YNc(26,R,2,2,"mat-option",20),e.qZA(),e.TgZ(27,"mat-hint"),e._uU(28,"Nomenclador de la Organizaci\xf3n Internacional del Trabajo OIT"),e.qZA(),e.qZA(),e.TgZ(29,"mat-form-field",15),e.TgZ(30,"mat-label"),e._uU(31,"Descripci\xf3n del Negocio"),e.qZA(),e._UZ(32,"mat-icon",21),e._UZ(33,"textarea",22),e.qZA(),e.qZA(),e.TgZ(34,"div",23),e.TgZ(35,"button",24),e._uU(36," Avanzar "),e.qZA(),e.qZA(),e.qZA(),e.TgZ(37,"mat-step",10,25),e.YNc(39,j,1,0,"ng-template",12),e.TgZ(40,"p",13),e._uU(41," La direcci\xf3n donde radica el negocio aporta confianza a los clientes a la hora de tomar una decisi\xf3n de compra. "),e.qZA(),e.TgZ(42,"div",26),e.TgZ(43,"mat-form-field",15),e.TgZ(44,"mat-label"),e._uU(45,"Direcci\xf3n"),e.qZA(),e._UZ(46,"mat-icon",21),e._UZ(47,"input",27),e.qZA(),e.TgZ(48,"mat-form-field",15),e.TgZ(49,"mat-label"),e._uU(50,"Provincia"),e.qZA(),e._UZ(51,"mat-icon",28),e.TgZ(52,"mat-select",29),e.YNc(53,D,2,2,"mat-option",20),e.qZA(),e.qZA(),e.TgZ(54,"mat-form-field",15),e.TgZ(55,"mat-label"),e._uU(56,"Municipio"),e.qZA(),e._UZ(57,"mat-icon",28),e.TgZ(58,"mat-select",29),e.YNc(59,Y,2,2,"mat-option",20),e.qZA(),e.qZA(),e.TgZ(60,"mat-form-field",15),e.TgZ(61,"mat-label"),e._uU(62,"Pa\xeds"),e.qZA(),e.TgZ(63,"mat-select",29),e.TgZ(64,"mat-option",30),e._uU(65,"Cuba"),e.qZA(),e.qZA(),e._UZ(66,"mat-icon",28),e.qZA(),e.qZA(),e.TgZ(67,"div",31),e.TgZ(68,"button",32),e._uU(69," Regresar "),e.qZA(),e.TgZ(70,"button",24),e._uU(71," Avanzar "),e.qZA(),e.qZA(),e.qZA(),e.TgZ(72,"mat-step",10),e.YNc(73,O,1,0,"ng-template",12),e.TgZ(74,"p",13),e._uU(75," Su logo es la imagen que van a recordar los clientes toda la vida. "),e.qZA(),e.TgZ(76,"div",33),e.TgZ(77,"div",34),e.TgZ(78,"div",35),e.TgZ(79,"div"),e.TgZ(80,"input",36,37),e.NdJ("change",function(){e.CHM(a);const c=e.MAs(81);return t.uploadLogo(c.files)}),e.qZA(),e.TgZ(82,"label",38),e._UZ(83,"mat-icon",39),e.qZA(),e.qZA(),e.TgZ(84,"div"),e.TgZ(85,"button",40),e.NdJ("click",function(){return t.removeLogo()}),e._UZ(86,"mat-icon",39),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(87,"div",41),e.TgZ(88,"button",32),e._uU(89," Regresar "),e.qZA(),e.TgZ(90,"button",42),e.NdJ("click",function(){return t.createBusiness()}),e.YNc(91,L,2,0,"span",43),e.YNc(92,M,1,2,"mat-progress-spinner",44),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&o){const a=e.MAs(12),l=e.MAs(38);e.xp6(6),e.Q6J("ngIf",t.alert),e.xp6(1),e.Q6J("formGroup",t.wizardBusinessForm),e.xp6(2),e.Q6J("linear",!0),e.xp6(2),e.Q6J("formGroupName","step1")("stepControl",t.wizardBusinessForm.get("step1")),e.xp6(9),e.Q6J("type","text")("formControlName","name")("placeholder","Nombre del negocio"),e.xp6(5),e.Q6J("formControlName","domain"),e.xp6(1),e.Q6J("ngForOf",t.domains)("ngForTrackBy",t.trackByFn),e.xp6(6),e.Q6J("svgIcon","heroicons_solid:menu-alt-2"),e.xp6(1),e.Q6J("formControlName","description")("rows",5)("spellcheck",!1),e.xp6(2),e.Q6J("color","primary")("disabled",a.stepControl.pristine||a.stepControl.invalid),e.xp6(2),e.Q6J("formGroupName","step2")("stepControl",t.wizardBusinessForm.get("step2")),e.xp6(9),e.Q6J("svgIcon","heroicons_solid:home"),e.xp6(1),e.Q6J("type","text")("formControlName","address"),e.xp6(4),e.Q6J("svgIcon","heroicons_solid:map"),e.xp6(1),e.Q6J("formControlName","state"),e.xp6(1),e.Q6J("ngForOf",t.states)("ngForTrackBy",t.trackByFn),e.xp6(4),e.Q6J("svgIcon","heroicons_solid:location-marker"),e.xp6(1),e.Q6J("formControlName","city"),e.xp6(1),e.Q6J("ngForOf",t.cities)("ngForTrackBy",t.trackByFn),e.xp6(4),e.Q6J("formControlName","country"),e.xp6(3),e.Q6J("svgIcon","heroicons_solid:globe"),e.xp6(2),e.Q6J("color","accent"),e.xp6(2),e.Q6J("color","primary")("disabled",l.stepControl.pristine||l.stepControl.invalid),e.xp6(2),e.Q6J("formGroupName","step3")("stepControl",t.wizardBusinessForm.get("step3")),e.xp6(8),e.Q6J("multiple",!1)("accept","image/jpeg, image/jpg, image/webp, image/png"),e.xp6(3),e.Q6J("svgIcon","heroicons_outline:camera"),e.xp6(3),e.Q6J("svgIcon","heroicons_outline:trash"),e.xp6(2),e.Q6J("color","accent"),e.xp6(2),e.Q6J("color","primary")("disabled",t.isLoading),e.xp6(1),e.Q6J("ngIf",!t.isLoading),e.xp6(1),e.Q6J("ngIf",t.isLoading)}},directives:[h.O5,r._Y,r.JL,r.sg,u.Vq,u.C0,r.x0,u.VY,p.KE,p.hX,J.Nt,r.Fj,r.Q7,r.JJ,r.u,U.gD,h.sg,p.bx,N.Hw,p.qo,Q.lW,u.Ic,Z.ey,u.fd,Z.wG,B.W],encapsulation:2,data:{animation:A.L}}),i})(),resolve:{data:T.y}}];let E=(()=>{class i{}return i.\u0275fac=function(o){return new(o||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[f.Bz.forChild(G),b.m]]}),i})()}}]);